import{_ as y,k as p,o as n,c as i,d as t,g as _,B as w,C as A,x as r,p as T,h as I,D as C,w as S,e as B,v as D,F as m,a as N,b as g,N as j,E as x,G as v,H as z,z as P,A as R}from"./index-4fd86721.js";import{P as k,D as U}from"./jquery.dataTables-46f718eb.js";const d=s=>(P("data-v-b0bc9ff4"),s=s(),R(),s),E={id:"wrapper"},F={id:"content-wrapper",class:"d-flex flex-column"},L={id:"content"},V=d(()=>t("h1",{class:"h3 mb-0 text-gray-800 text-center"},"Pembayaran",-1)),M={class:"row"},J=d(()=>t("div",{class:"col-1"},null,-1)),O={class:"col-10"},K=N('<div class="row mt-5" data-v-b0bc9ff4><div class="col-sm-3" data-v-b0bc9ff4></div><div class="col-sm-9" data-v-b0bc9ff4><button class="btn btn-warning me-2" data-v-b0bc9ff4>Pending</button><button class="btn btn-success me-2" data-v-b0bc9ff4>Active</button><button class="btn btn-secondary me-2" data-v-b0bc9ff4>Expired</button><button class="btn btn-danger" data-v-b0bc9ff4>Reject</button></div></div>',1),W={class:"table-responsive"},G={key:0,class:"preloader"},H=d(()=>t("thead",null,[t("tr",null,[t("th",{scope:"col"},"No"),t("th",{scope:"col"},"No. Rekening"),t("th",{scope:"col"},"Jumlah Transfer"),t("th",{scope:"col"},"Bukti Transfer"),t("th",{scope:"col"},"Status"),t("th",{scope:"col"},"Aksi")])],-1)),q={scope:"row"},Q=["src","onClick"],X={key:0,class:"bg-warning"},Y={key:1,class:"bg-success"},Z={key:2,class:"bg-grey"},tt={key:3,class:"bg-danger"},et=["onClick"],at=["onClick"],st=["onClick"],ot=d(()=>t("div",{class:"col-1"},null,-1)),nt={class:"modal fade",id:"aturTanggal",tabindex:"-1",role:"dialog","aria-labelledby":"aturTanggalLabel","aria-hidden":"true",ref:"aturTanggalRef"},it={class:"modal-dialog",role:"document"},lt={class:"modal-content"},rt=d(()=>t("div",{class:"modal-header"},[t("h5",{class:"modal-title",id:"addInvoiceModalLabel"},"Atur Tanggal"),t("button",{type:"button",class:"close","data-dismiss":"modal","aria-label":"Close"},[t("span",{"aria-hidden":"true"},"×")])],-1)),dt={class:"modal-body"},ct={class:"form-group"},ut=d(()=>t("label",{for:"tanggal"},"Tanggal Berakhir",-1)),ht=d(()=>t("div",{class:"modal-footer"},[t("button",{type:"button",class:"btn btn-secondary","data-dismiss":"modal"}," Close "),t("button",{type:"submit",class:"btn btn-primary"},"Simpan")],-1)),bt={class:"modal fade",id:"detailBukti",tabindex:"-1",role:"dialog","aria-labelledby":"detailBuktiLabel","aria-hidden":"true",ref:"detailBuktiRef"},_t={class:"modal-dialog",role:"document"},gt={class:"modal-content"},vt=d(()=>t("div",{class:"modal-header"},[t("h5",{class:"modal-title",id:"addInvoiceModalLabel"}," Detail Bukti Transfer "),t("button",{type:"button",class:"close","data-dismiss":"modal","aria-label":"Close"},[t("span",{"aria-hidden":"true"},"×")])],-1)),pt={class:"modal-body"},mt=["src"],kt=d(()=>t("div",{class:"modal-footer"},[t("button",{type:"button",class:"btn btn-secondary","data-dismiss":"modal"}," Close ")],-1));k.use(U);const ft={data(){return{invoices:[],ready:null,user_id:null,path:null,dataAction:{user_id:"",invoice_id:"",status_invoice:"",tanggal_berakhir:""}}},methods:{setDataAction(s,o,l){this.dataAction.user_id=s,this.dataAction.invoice_id=o,this.dataAction.status_invoice=l},async getAllDataInvoice(){try{const s=await g.get("https://backend-webmember.lumirainternational.com/api/auth/list-invoice",{headers:{Authorization:"Bearer "+sessionStorage.getItem("token")}});this.invoices=s.data.data,this.ready=!0,console.log("ini invoice",this.invoices)}catch(s){console.error(s)}},detailBukti(s){this.path=s,$("#detailBukti").modal("show")},async aturTanggal(){try{const s=new FormData;s.append("user_id",this.user_id),s.append("invoice_id",this.selectedInvoice),s.append("tanggal_berakhir",this.date);const o=await g.post("https://backend-webmember.lumirainternational.com/api/auth/atur-tanggal",s,{headers:{Authorization:"Bearer "+sessionStorage.getItem("token")}});this.ready=!1,this.getAllDataInvoice(),console.log("ini invoice",this.invoices)}catch(s){console.error(s)}},async actionInvoice(s,o,l,u=null){try{let e=new FormData;e.append("user_id",s),e.append("invoice_id",o),e.append("status_invoice",l),u!=null&&e.append("tanggal_berakhir",u);const c=await g.post("http://127.0.0.1:8000/api/auth/action-invoice",e,{headers:{Authorization:"Bearer "+sessionStorage.getItem("token")}});console.log("Invoice berhasil ditolak:",c.data),this.ready=!1,this.getAllDataInvoice()}catch(e){console.error("Terjadi kesalahan:",e)}}},created(){const s=new Date().toUTCString();console.log("Waktu Sekarang (UTC):",s);const o=sessionStorage.getItem("token");if(o)try{const[l,u]=o.split("."),e=JSON.parse(atob(l)),c=atob(u),a=JSON.parse(atob(o.split(".")[1])),b=a.exp,h=new Date(b*1e3);console.log("Waktu Kedaluwarsa (UTC):",h.toUTCString()),new Date>h?(console.log("Keluar"),sessionStorage.removeItem("token"),this.$router.push("/")):console.log("Aman");const f=a.level;this.user_id=a.id,f!=="1"?this.$router.push("/unauthorized"):(!e||!c)&&(this.$router.push("/"),sessionStorage.removeItem("token")),this.getAllDataInvoice()}catch(l){console.error("Error decoding token:",l),this.$router.push("/")}else this.$router.push("/")}},yt=Object.assign(ft,{__name:"Invoices",setup(s){const o=p(!1),l=p(""),u=()=>{o.value=!o.value,l.value=o.value?"toggle-sidebar":""};return(e,c)=>(n(),i(m,null,[t("div",E,[_(A,{class:w(l.value)},null,8,["class"]),t("div",F,[t("div",L,[_(j,{onToggleSidebar:u}),V,t("div",M,[J,t("div",O,[K,t("div",W,[e.ready?r("",!0):(n(),i("div",G)),e.ready?(n(),T(C(k),{key:1,class:"display table table-striped"},{default:I(()=>[H,t("tbody",null,[(n(!0),i(m,null,x(e.invoices,(a,b)=>(n(),i("tr",{key:a.id},[t("th",q,v(b+1),1),t("td",null,v(a.nomor_rekening),1),t("td",null,v(a.jumlah_transfer),1),t("td",null,[t("img",{src:"https://backend-webmember.lumirainternational.com/storage/"+a.bukti_transfer,alt:"Bukti Transfer",style:{"max-width":"100px",cursor:"pointer"},onClick:h=>e.detailBukti(a.bukti_transfer)},null,8,Q)]),t("td",null,[a.status=="0"?(n(),i("div",X,"Pending")):r("",!0),a.status=="1"?(n(),i("div",Y,"Active")):r("",!0),a.status=="2"?(n(),i("div",Z,"Expired")):r("",!0),a.status=="3"?(n(),i("div",tt,"Reject")):r("",!0)]),t("td",null,[a.status=="1"?(n(),i("button",{key:0,class:"btn btn-danger",onClick:h=>e.actionInvoice(a.user_id,a.id,"2")}," Reject ",8,et)):r("",!0),a.status=="0"?(n(),i("button",{key:1,class:"btn btn-primary",onClick:h=>e.setDataAction(a.user_id,a.id,"1"),"data-toggle":"modal","data-target":"#aturTanggal"}," Active ",8,at)):r("",!0),a.status=="3"?(n(),i("button",{key:2,class:"btn btn-success",onClick:h=>e.setDataAction(a.user_id,a.id,"3"),"data-toggle":"modal","data-target":"#aturTanggal"}," Perpanjang ",8,st)):r("",!0)])]))),128))])]),_:1})):r("",!0)])]),ot])]),_(z)])]),t("div",nt,[t("div",it,[t("div",lt,[rt,t("div",dt,[t("form",{onSubmit:c[1]||(c[1]=S(a=>e.actionInvoice(e.dataAction.user_id,e.dataAction.invoice_id,e.dataAction.status_invoice,e.dataAction.tanggal_berakhir),["prevent"]))},[t("div",ct,[ut,B(t("input",{type:"date",class:"form-control",id:"tanggal","onUpdate:modelValue":c[0]||(c[0]=a=>e.dataAction.tanggal_berakhir=a)},null,512),[[D,e.dataAction.tanggal_berakhir]])]),ht],32)])])])],512),t("div",bt,[t("div",_t,[t("div",gt,[vt,t("div",pt,[t("img",{src:"https://backend-webmember.lumirainternational.com/storage/"+e.path,alt:"Bukti Transfer",style:{width:"100%"}},null,8,mt),kt])])])],512)],64))}}),Tt=y(yt,[["__scopeId","data-v-b0bc9ff4"]]);export{Tt as default};
