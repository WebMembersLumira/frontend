import{S as p,N as g}from"./Navbar-480ab674.js";import{_,k as c,o as m,c as b,g as r,B as k,d as t,b as d,H as f,z as v,A as w}from"./index-42287595.js";import{C as y}from"./ChatMe-f254a1a1.js";const x=e=>(v("data-v-ae2a8ff8"),e=e(),w(),e),S={id:"wrapper"},A={id:"content-wrapper",class:"d-flex flex-column"},B={id:"content"},I=x(()=>t("h1",{class:"h3 mb-0 text-gray-800 text-center mt-4"},"Layanan",-1)),$={class:"d-flex justify-content-center"},L=["src"],T={data(){return{user_id:null,role:null,ready:null,link:""}},methods:{async checkMembership(){try{const e=await d.get(`https://backend-webmember.lumirainternational.com/api/auth/check-membership/${this.user_id}`,{headers:{Authorization:"Bearer "+sessionStorage.getItem("token")}});this.ready=!0,console.log("data:",e.data.status),e.data.status===401?this.showAlert("Anda belum berlangganan, silahkan berlangganan dulu"):new Date(e.data.data[0].tanggal_berakhir)<new Date&&this.showAlert("Anda belum berlangganan, silahkan berlangganan terlebih dulu!!"),this.getLink()}catch(e){console.error(e)}},async getLink(){try{const e=await d.get("https://backend-webmember.lumirainternational.com/api/auth/get-link",{headers:{Authorization:"Bearer "+sessionStorage.getItem("token")}});console.log("link: ",e.data.data[0].link),this.link=e.data.data[0].link}catch(e){console.error(e)}},showAlert(e){this.$swal({title:"Layanan Tidak Tersedia",text:e,icon:"error"}).then(()=>{this.$router.push("user-invoice")})}},created(){const e=sessionStorage.getItem("token");if(e)try{const[a,s]=e.split("."),n=JSON.parse(atob(a)),i=atob(s),o=JSON.parse(atob(e.split(".")[1])),h=o.exp,l=new Date(h*1e3);console.log("Waktu Kedaluwarsa (UTC):",l.toUTCString()),new Date>l?(console.log("Keluar"),sessionStorage.removeItem("token"),this.$router.push("/")):console.log("Aman");const u=o.level;this.user_id=o.id,console.log("ini idddd:",this.user_id),u!=="0"?this.$router.push("/unauthorized"):(!n||!i)&&this.$router.push("/"),this.checkMembership()}catch(a){console.error("Error decoding token:",a),this.$router.push("/")}else this.$router.push("/")}},C=Object.assign(T,{__name:"Layanan",setup(e){const a=c(!1),s=c(""),n=()=>{a.value=!a.value,s.value=a.value?"toggle-sidebar":""};return(i,o)=>(m(),b("div",S,[r(p,{class:k(s.value)},null,8,["class"]),t("div",A,[t("div",B,[r(g,{onToggleSidebar:n}),r(y),I,t("div",$,[t("iframe",{src:i.link,width:"95%",height:"500px",frameborder:"0",allowfullscreen:""},null,8,L)])]),r(f)])]))}}),M=_(C,[["__scopeId","data-v-ae2a8ff8"]]);export{M as default};
