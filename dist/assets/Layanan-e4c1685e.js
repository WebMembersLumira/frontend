import{N as p}from"./Navbar-1cabdf4a.js";import{_ as g,j as c,o as _,c as m,d as a,f as i,b as d,G as b,y as k,z as f}from"./index-39a6128f.js";import{C as w}from"./ChatMe-bfef94f2.js";const y=e=>(k("data-v-c9f56d0c"),e=e(),f(),e),v={id:"wrapper"},x={id:"content-wrapper",class:"d-flex flex-column"},S={id:"content"},A=y(()=>a("h1",{class:"h3 mb-0 text-gray-800 text-center mt-4"},"Layanan",-1)),I={class:"d-flex justify-content-center"},$=["src"],B={data(){return{user_id:null,role:null,ready:null,link:""}},methods:{async checkMembership(){try{const e=await d.get(`https://backend-webmember.lumirainternational.com/api/auth/check-membership/${this.user_id}`,{headers:{Authorization:"Bearer "+sessionStorage.getItem("token")}});this.ready=!0,console.log("data:",e.data.status),e.data.status===401?this.showAlert("Anda belum berlangganan, silahkan berlangganan dulu"):new Date(e.data.data[0].tanggal_berakhir)<new Date?this.showAlert("Anda belum berlangganan, silahkan berlangganan terlebih dulu!!"):this.getLink()}catch(e){console.error(e)}},async getLink(){try{const e=await d.get("https://backend-webmember.lumirainternational.com/api/auth/get-link",{headers:{Authorization:"Bearer "+sessionStorage.getItem("token")}});console.log("link: ",e.data.data[0].link),this.link=e.data.data[0].link}catch(e){console.error(e)}},showAlert(e){this.$swal({title:"Layanan Tidak Tersedia",text:e,icon:"error"}).then(()=>{this.$router.push("user-invoice")})}},created(){const e=sessionStorage.getItem("token");if(e)try{const[t,o]=e.split("."),r=JSON.parse(atob(t)),n=atob(o),s=JSON.parse(atob(e.split(".")[1])),h=s.exp,l=new Date(h*1e3);console.log("Waktu Kedaluwarsa (UTC):",l.toUTCString()),new Date>l?(console.log("Keluar"),sessionStorage.removeItem("token"),this.$router.push("/")):console.log("Aman");const u=s.level;this.user_id=s.id,console.log("ini idddd:",this.user_id),u!=="0"?this.$router.push("/unauthorized"):(!r||!n)&&this.$router.push("/"),this.checkMembership()}catch(t){console.error("Error decoding token:",t),this.$router.push("/")}else this.$router.push("/")}},L=Object.assign(B,{__name:"Layanan",setup(e){const t=c(!1),o=c(""),r=()=>{t.value=!t.value,o.value=t.value?"toggle-sidebar":""};return(n,s)=>(_(),m("div",v,[a("div",x,[a("div",S,[i(p,{onToggleSidebar:r}),i(w),A,a("div",I,[a("iframe",{src:n.link,width:"95%",height:"500px",frameborder:"0",allowfullscreen:""},null,8,$)])]),i(b)])]))}}),D=g(L,[["__scopeId","data-v-c9f56d0c"]]);export{D as default};
