import{N as _}from"./Navbar-821ee131.js";import{_ as g,j as c,o as m,c as b,d as a,f as i,b as d,G as k,y as f,z as w}from"./index-aae8d69f.js";import{C as y}from"./ChatMe-cb507ad8.js";const h=e=>(f("data-v-c13b6134"),e=e(),w(),e),v={id:"wrapper",oncontextmenu:"return false",onkeydown:"return false;",onmousedown:"return false;"},x={id:"content-wrapper",class:"d-flex flex-column"},S={id:"content"},A=h(()=>a("h1",{class:"h3 mb-0 text-gray-800 text-center mt-4"},"Layanan",-1)),B={class:"d-flex justify-content-center"},I=["data"],$=h(()=>a("p",null,"Browser tidak mendukung.",-1)),L=[$],T={data(){return{user_id:null,role:null,ready:null,link:""}},methods:{async checkMembership(){try{const e=await d.get(`https://backend-webmember.lumirainternational.com/api/auth/check-membership/${this.user_id}`,{headers:{Authorization:"Bearer "+sessionStorage.getItem("token")}});this.ready=!0,console.log("data:",e.data.status),e.data.status===401?this.showAlert("Anda belum berlangganan, silahkan berlangganan dulu"):new Date(e.data.data[0].tanggal_berakhir)<new Date?this.showAlert("Anda belum berlangganan, silahkan berlangganan terlebih dulu!!"):this.getLink()}catch(e){console.error(e)}},async getLink(){try{const e=await d.get("https://backend-webmember.lumirainternational.com/api/auth/get-link",{headers:{Authorization:"Bearer "+sessionStorage.getItem("token")}});console.log("link: ",e.data.data[0].link),this.link=e.data.data[0].link}catch(e){console.error(e)}},showAlert(e){this.$swal({title:"Layanan Tidak Tersedia",text:e,icon:"error"}).then(()=>{this.$router.push("user-invoice")})}},created(){const e=sessionStorage.getItem("token");if(e)try{const[t,o]=e.split("."),n=JSON.parse(atob(t)),r=atob(o),s=JSON.parse(atob(e.split(".")[1])),u=s.exp,l=new Date(u*1e3);console.log("Waktu Kedaluwarsa (UTC):",l.toUTCString()),new Date>l?(console.log("Keluar"),sessionStorage.removeItem("token"),this.$router.push("/")):console.log("Aman");const p=s.level;this.user_id=s.id,console.log("ini idddd:",this.user_id),p!=="0"?this.$router.push("/unauthorized"):(!n||!r)&&this.$router.push("/"),this.checkMembership()}catch(t){console.error("Error decoding token:",t),this.$router.push("/")}else this.$router.push("/")}},N=Object.assign(T,{__name:"Layanan",setup(e){const t=c(!1),o=c(""),n=()=>{t.value=!t.value,o.value=t.value?"toggle-sidebar":""};return(r,s)=>(m(),b("div",v,[a("div",x,[a("div",S,[i(_,{onToggleSidebar:n}),i(y),A,a("div",B,[a("object",{data:r.link,type:"text/html",width:"100%",height:"500px"},L,8,I)])]),i(k)])]))}}),z=g(N,[["__scopeId","data-v-c13b6134"]]);export{z as default};
