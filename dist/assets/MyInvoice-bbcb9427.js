import{_ as I,k as p,o as i,c as u,d as e,g as h,B,x as g,p as T,h as D,D as S,w as M,e as m,f as v,v as b,F as f,b as k,E as j,G as r,H as C,z as R,A as U}from"./index-4fd86721.js";import{S as N}from"./Sidebar-User-d7e1f51d.js";import{N as x}from"./Navbar-9bb9397c.js";import{C as P}from"./ChatMe-676e7c38.js";import{P as y,D as A}from"./jquery.dataTables-46f718eb.js";const a=t=>(R("data-v-e1cc7707"),t=t(),U(),t),F={id:"wrapper"},L={id:"content-wrapper",class:"d-flex flex-column"},V={id:"content"},z=a(()=>e("h1",{class:"h3 mb-0 text-gray-800 text-center mt-4"},"List Invoice",-1)),J={class:"row"},E=a(()=>e("div",{class:"col-1"},null,-1)),O={class:"col-10"},W=a(()=>e("div",{class:"row mt-5"},[e("div",{class:"col-sm-3"},[e("button",{class:"btn blueButton","data-toggle":"modal","data-target":"#addInvoiceModal"}," Tambah Layanan ")]),e("div",{class:"col-sm-9"})],-1)),H={class:"table-responsive mt-5"},K={key:0,class:"preloader"},G=a(()=>e("thead",null,[e("tr",null,[e("th",{scope:"col"},"No"),e("th",{scope:"col"},"Nomor Rekening"),e("th",{scope:"col"},"Jumlah Transfer"),e("th",{scope:"col"},"Bukti Transfer"),e("th",{scope:"col"},"Berlaku Hingga"),e("th",{scope:"col"},"Status"),e("th",{scope:"col"},"Aksi")])],-1)),q={scope:"row"},Q=["src"],X=a(()=>e("td",null,null,-1)),Y=a(()=>e("div",{class:"col-1"},null,-1)),Z={class:"modal fade",id:"addInvoiceModal",tabindex:"-1",role:"dialog","aria-labelledby":"addInvoiceModalLabel","aria-hidden":"true",ref:"addInvoiceModalRef"},ee={class:"modal-dialog",role:"document"},oe={class:"modal-content"},te=a(()=>e("div",{class:"modal-header"},[e("h5",{class:"modal-title",id:"addInvoiceModalLabel"},"Tambah Invoice"),e("button",{type:"button",class:"close","data-dismiss":"modal","aria-label":"Close"},[e("span",{"aria-hidden":"true"},"Ã—")])],-1)),ae={class:"modal-body"},se={class:"form-group"},ne=a(()=>e("label",{for:"nomorRekening"},"Waktu Langganan",-1)),le=a(()=>e("option",{value:"0",selected:""},"Pilih Waktu Langganan",-1)),ie=a(()=>e("option",{value:"mandiri"},"1 Bulan",-1)),re=a(()=>e("option",{value:"bri"},"6 Bulan",-1)),de=a(()=>e("option",{value:"bni"},"1 Tahun",-1)),ce=[le,ie,re,de],ue={class:"form-group"},he=a(()=>e("label",{for:"nomorRekening"},"Rekening Tujuan",-1)),me=a(()=>e("option",{value:"0",selected:""},"Pilih Rekening Tujuan",-1)),_e=a(()=>e("option",{value:"mandiri"},"Mandiri - Bagus Untoro - 23472347234324",-1)),pe=a(()=>e("option",{value:"bri"},"BRI - Bagus Untoro - 23472347234324",-1)),ge=a(()=>e("option",{value:"bni"},"BNI - Bagus Untoro - 23472347234324",-1)),ve=[me,_e,pe,ge],be=a(()=>e("div",{class:"form-group"},[e("label",{for:"nomorRekening"},"Jumlah Bayar"),e("input",{type:"text",class:"form-control",id:"nomorRekening",value:"100000",disabled:""})],-1)),fe={class:"form-group"},ke=a(()=>e("label",{for:"nomorRekening"},"Nomor Rekening",-1)),ye={class:"form-group"},we=a(()=>e("label",{for:"jumlahTransfer"},"Jumlah Transfer",-1)),Ie={class:"form-group"},Be=a(()=>e("label",{for:"buktiTransfer"},"Bukti Transfer",-1)),Te=a(()=>e("div",{class:"modal-footer"},[e("button",{type:"button",class:"btn btn-secondary","data-dismiss":"modal"}," Close "),e("button",{type:"submit",class:"btn btn-primary"},"Tambah")],-1));y.use(A);const De={data(){return{invoices:[],newInvoice:{nomor_rekening:"",jumlah_transfer:"",bukti_transfer:null},user_id:null,role:null,ready:null,today:null}},methods:{async fetchDataInvoice(){try{const t=await k.get(`https://backend-webmember.lumirainternational.com/api/auth/list-myinvoice/${this.user_id}`,{headers:{Authorization:"Bearer "+sessionStorage.getItem("token")}});this.invoices=t.data.data,this.ready=!0,console.log("tanggal :",t.data.data[0].tanggal_berakhir),console.log(new Date(t.data.data[0].tanggal_berakhir)<new Date),console.log("sekarang:",new Date)}catch(t){console.error(t)}},addInvoice(){const t=new FormData;t.append("nomor_rekening",this.newInvoice.nomor_rekening),t.append("jumlah_transfer",this.newInvoice.jumlah_transfer),t.append("bukti_transfer",this.newInvoice.bukti_transfer),t.append("user_id",this.user_id),k.post("https://backend-webmember.lumirainternational.com/api/auth/create-invoice",t,{headers:{"Content-Type":"multipart/form-data",Authorization:"Bearer "+sessionStorage.getItem("token")}}).then(l=>{console.log(l.data),this.newInvoice={nomor_rekening:"",jumlah_transfer:"",bukti_transfer:null},this.showAlert()}).catch(l=>{console.error(l)})},showAlert(){this.$swal("Data Berhasil Dikirm!!").then(()=>{$("#addInvoiceModal").modal("hide")})},handleFileUpload(t){this.newInvoice.bukti_transfer=t.target.files[0]}},created(){const t=sessionStorage.getItem("token");if(t)try{const[l,d]=t.split("."),_=JSON.parse(atob(l)),s=atob(d),n=JSON.parse(atob(t.split(".")[1])),o=n.exp,c=new Date(o*1e3);console.log("Waktu Kedaluwarsa (UTC):",c.toUTCString()),new Date>c?(console.log("Keluar"),sessionStorage.removeItem("token"),this.$router.push("/")):console.log("Aman");const w=n.level;this.user_id=n.id,console.log("ini idddd:",this.user_id),w!=="0"?this.$router.push("/unauthorized"):(!_||!s)&&this.$router.push("/"),this.fetchDataInvoice(),this.today=new Date}catch(l){console.error("Error decoding token:",l),this.$router.push("/")}else this.$router.push("/")}},Se=Object.assign(De,{__name:"MyInvoice",setup(t){const l=p(!1),d=p(""),_=()=>{l.value=!l.value,d.value=l.value?"toggle-sidebar":""};return(s,n)=>(i(),u(f,null,[e("div",F,[h(N,{class:B(d.value)},null,8,["class"]),e("div",L,[e("div",V,[h(x,{onToggleSidebar:_}),h(P),z,e("div",J,[E,e("div",O,[W,e("div",H,[s.ready?g("",!0):(i(),u("div",K)),s.ready?(i(),T(S(y),{key:1,class:"tableCustom display table table-striped"},{default:D(()=>[G,e("tbody",null,[(i(!0),u(f,null,j(s.invoices,(o,c)=>(i(),u("tr",{key:o.id},[e("th",q,r(c+1),1),e("td",null,r(o.nomor_rekening),1),e("td",null,r(o.jumlah_transfer),1),e("td",null,[e("img",{src:"https://backend-webmember.lumirainternational.com/storage/"+o.bukti_transfer,alt:"Bukti Transfer",style:{"max-width":"100px"}},null,8,Q)]),e("td",null,r(o.tanggal_berakhir!=null?o.tanggal_berakhir:"Belum Diatur"),1),e("td",null,r(o.status==="0"?"Pending":o.status==="1"?"Active":o.status==="2"?"Expired":"Reject"),1),X]))),128))])]),_:1})):g("",!0)])]),Y])]),h(C)])]),e("div",Z,[e("div",ee,[e("div",oe,[te,e("div",ae,[e("form",{onSubmit:n[5]||(n[5]=M((...o)=>s.addInvoice&&s.addInvoice(...o),["prevent"]))},[e("div",se,[ne,m(e("select",{class:"form-select","aria-label":"Default select example","onUpdate:modelValue":n[0]||(n[0]=o=>s.metodePembayaran=o)},ce,512),[[v,s.metodePembayaran]])]),e("div",ue,[he,m(e("select",{class:"form-select","aria-label":"Default select example","onUpdate:modelValue":n[1]||(n[1]=o=>s.metodePembayaran=o)},ve,512),[[v,s.metodePembayaran]])]),be,e("div",fe,[ke,m(e("input",{type:"text",class:"form-control",id:"nomorRekening","onUpdate:modelValue":n[2]||(n[2]=o=>s.newInvoice.nomor_rekening=o)},null,512),[[b,s.newInvoice.nomor_rekening]])]),e("div",ye,[we,m(e("input",{type:"text",class:"form-control",id:"jumlahTransfer","onUpdate:modelValue":n[3]||(n[3]=o=>s.newInvoice.jumlah_transfer=o)},null,512),[[b,s.newInvoice.jumlah_transfer]])]),e("div",Ie,[Be,e("input",{type:"file",class:"form-control",id:"buktiTransfer",onChange:n[4]||(n[4]=(...o)=>s.handleFileUpload&&s.handleFileUpload(...o))},null,32)]),Te],32)])])])],512)],64))}}),Ne=I(Se,[["__scopeId","data-v-e1cc7707"]]);export{Ne as default};
