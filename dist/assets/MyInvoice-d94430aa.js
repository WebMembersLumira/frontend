import{_ as y,k as _,o as l,c as u,d as e,g as h,B as I,x as p,p as T,h as D,D as S,w as B,e as v,v as g,F as b,b as f,E as C,G as i,H as M,z as j,A as x}from"./index-734b0cc5.js";import{S as N}from"./Sidebar-User-b57f27e8.js";import{N as A}from"./Navbar-112cf9ad.js";import{C as F}from"./ChatMe-a4cb3bdb.js";import{P as k,D as U}from"./jquery.dataTables-5e1378cc.js";const r=t=>(j("data-v-048dd053"),t=t(),x(),t),R={id:"wrapper"},z={id:"content-wrapper",class:"d-flex flex-column"},V={id:"content"},E=r(()=>e("h1",{class:"h3 mb-0 text-gray-800 text-center mt-4"},"List Invoice",-1)),J={class:"row"},L=r(()=>e("div",{class:"col-1"},null,-1)),O={class:"col-10"},P=r(()=>e("div",{class:"row mt-5"},[e("div",{class:"col-sm-3"},[e("button",{class:"btn blueButton","data-toggle":"modal","data-target":"#addInvoiceModal"}," Tambah Invoice ")]),e("div",{class:"col-sm-9"})],-1)),H={class:"table-responsive mt-5"},K={key:0,class:"preloader"},G=r(()=>e("thead",null,[e("tr",null,[e("th",{scope:"col"},"No"),e("th",{scope:"col"},"Nomor Rekening"),e("th",{scope:"col"},"Jumlah Transfer"),e("th",{scope:"col"},"Bukti Transfer"),e("th",{scope:"col"},"Berlaku Hingga"),e("th",{scope:"col"},"Status"),e("th",{scope:"col"},"Aksi")])],-1)),W={scope:"row"},q=["src"],Q=r(()=>e("td",null,null,-1)),X=r(()=>e("div",{class:"col-1"},null,-1)),Y={class:"modal fade",id:"addInvoiceModal",tabindex:"-1",role:"dialog","aria-labelledby":"addInvoiceModalLabel","aria-hidden":"true",ref:"addInvoiceModalRef"},Z={class:"modal-dialog",role:"document"},ee={class:"modal-content"},te=r(()=>e("div",{class:"modal-header"},[e("h5",{class:"modal-title",id:"addInvoiceModalLabel"},"Tambah Invoice"),e("button",{type:"button",class:"close","data-dismiss":"modal","aria-label":"Close"},[e("span",{"aria-hidden":"true"},"Ã—")])],-1)),oe={class:"modal-body"},ae={class:"form-group"},se=r(()=>e("label",{for:"nomorRekening"},"Nomor Rekening",-1)),ne={class:"form-group"},re=r(()=>e("label",{for:"jumlahTransfer"},"Jumlah Transfer",-1)),le={class:"form-group"},ie=r(()=>e("label",{for:"buktiTransfer"},"Bukti Transfer",-1)),de=r(()=>e("div",{class:"modal-footer"},[e("button",{type:"button",class:"btn btn-secondary","data-dismiss":"modal"}," Close "),e("button",{type:"submit",class:"btn btn-primary"},"Tambah")],-1));k.use(U);const ce={data(){return{invoices:[],newInvoice:{nomor_rekening:"",jumlah_transfer:"",bukti_transfer:null},user_id:null,role:null,ready:null,today:null}},methods:{async fetchDataInvoice(){try{const t=await f.get(`https://backend-webmember.lumirainternational.com/api/auth/list-myinvoice/${this.user_id}`,{headers:{Authorization:"Bearer "+sessionStorage.getItem("token")}});this.invoices=t.data.data,this.ready=!0,console.log("tanggal :",t.data.data[0].tanggal_berakhir),console.log(new Date(t.data.data[0].tanggal_berakhir)<new Date),console.log("sekarang:",new Date)}catch(t){console.error(t)}},addInvoice(){const t=new FormData;t.append("nomor_rekening",this.newInvoice.nomor_rekening),t.append("jumlah_transfer",this.newInvoice.jumlah_transfer),t.append("bukti_transfer",this.newInvoice.bukti_transfer),t.append("user_id",this.user_id),f.post("https://backend-webmember.lumirainternational.com/api/auth/create-invoice",t,{headers:{"Content-Type":"multipart/form-data",Authorization:"Bearer "+sessionStorage.getItem("token")}}).then(n=>{console.log(n.data),this.newInvoice={nomor_rekening:"",jumlah_transfer:"",bukti_transfer:null},this.showAlert()}).catch(n=>{console.error(n)})},showAlert(){this.$swal("Data Berhasil Dikirm!!").then(()=>{$("#addInvoiceModal").modal("hide")})},handleFileUpload(t){this.newInvoice.bukti_transfer=t.target.files[0]}},created(){const t=sessionStorage.getItem("token");if(t)try{const[n,d]=t.split("."),m=JSON.parse(atob(n)),a=atob(d),s=JSON.parse(atob(t.split(".")[1])),o=s.exp,c=new Date(o*1e3);console.log("Waktu Kedaluwarsa (UTC):",c.toUTCString()),new Date>c?(console.log("Keluar"),sessionStorage.removeItem("token"),this.$router.push("/")):console.log("Aman");const w=s.level;this.user_id=s.id,console.log("ini idddd:",this.user_id),w!=="0"?this.$router.push("/unauthorized"):(!m||!a)&&this.$router.push("/"),this.fetchDataInvoice(),this.today=new Date}catch(n){console.error("Error decoding token:",n),this.$router.push("/")}else this.$router.push("/")}},ue=Object.assign(ce,{__name:"MyInvoice",setup(t){const n=_(!1),d=_(""),m=()=>{n.value=!n.value,d.value=n.value?"toggle-sidebar":""};return(a,s)=>(l(),u(b,null,[e("div",R,[h(N,{class:I(d.value)},null,8,["class"]),e("div",z,[e("div",V,[h(A,{onToggleSidebar:m}),h(F),E,e("div",J,[L,e("div",O,[P,e("div",H,[a.ready?p("",!0):(l(),u("div",K)),a.ready?(l(),T(S(k),{key:1,class:"tableCustom display table table-striped"},{default:D(()=>[G,e("tbody",null,[(l(!0),u(b,null,C(a.invoices,(o,c)=>(l(),u("tr",{key:o.id},[e("th",W,i(c+1),1),e("td",null,i(o.nomor_rekening),1),e("td",null,i(o.jumlah_transfer),1),e("td",null,[e("img",{src:"https://backend-webmember.lumirainternational.com/storage/"+o.bukti_transfer,alt:"Bukti Transfer",style:{"max-width":"100px"}},null,8,q)]),e("td",null,i(o.tanggal_berakhir!=null?o.tanggal_berakhir:"Belum Diatur"),1),e("td",null,i(o.status==="0"?"Pending":o.status==="1"?"Active":o.status==="2"?"Expired":"Reject"),1),Q]))),128))])]),_:1})):p("",!0)])]),X])]),h(M)])]),e("div",Y,[e("div",Z,[e("div",ee,[te,e("div",oe,[e("form",{onSubmit:s[3]||(s[3]=B((...o)=>a.addInvoice&&a.addInvoice(...o),["prevent"]))},[e("div",ae,[se,v(e("input",{type:"text",class:"form-control",id:"nomorRekening","onUpdate:modelValue":s[0]||(s[0]=o=>a.newInvoice.nomor_rekening=o)},null,512),[[g,a.newInvoice.nomor_rekening]])]),e("div",ne,[re,v(e("input",{type:"text",class:"form-control",id:"jumlahTransfer","onUpdate:modelValue":s[1]||(s[1]=o=>a.newInvoice.jumlah_transfer=o)},null,512),[[g,a.newInvoice.jumlah_transfer]])]),e("div",le,[ie,e("input",{type:"file",class:"form-control",id:"buktiTransfer",onChange:s[2]||(s[2]=(...o)=>a.handleFileUpload&&a.handleFileUpload(...o))},null,32)]),de],32)])])])],512)],64))}}),ge=y(ue,[["__scopeId","data-v-048dd053"]]);export{ge as default};
