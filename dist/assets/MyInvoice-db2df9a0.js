import{_ as w,k as v,o as d,c as u,d as e,g as h,B as j,x as m,p as T,h as B,D,w as _,e as r,v as l,F as k,b as f,E as U,G as g,H as S,z as C,A as M}from"./index-42287595.js";import{S as P,N as V}from"./Navbar-480ab674.js";import{C as R}from"./ChatMe-f254a1a1.js";import{P as y,D as F}from"./jquery.dataTables-77aab3c6.js";const n=s=>(C("data-v-928d7acd"),s=s(),M(),s),A={id:"wrapper"},J={id:"content-wrapper",class:"d-flex flex-column"},L={id:"content"},N=n(()=>e("h1",{class:"h3 mb-0 text-gray-800 text-center mt-4"},"List Invoice",-1)),x={class:"row"},z=n(()=>e("div",{class:"col-1"},null,-1)),E={class:"col-10"},O=n(()=>e("div",{class:"row mt-5"},[e("div",{class:"col-sm-3"},[e("button",{class:"btn blueButton","data-toggle":"modal","data-target":"#addInvoiceModal"}," Tambah Layanan ")]),e("div",{class:"col-sm-9"})],-1)),H={class:"table-responsive mt-5"},K={key:0,class:"preloader"},q=n(()=>e("thead",null,[e("tr",null,[e("th",{scope:"col"},"No"),e("th",{scope:"col"},"Nomor Rekening"),e("th",{scope:"col"},"Jumlah Transfer"),e("th",{scope:"col"},"Bukti Transfer"),e("th",{scope:"col"},"Berlaku Hingga"),e("th",{scope:"col"},"Status"),e("th",{scope:"col"},"Aksi")])],-1)),G={scope:"row"},W=["src"],Q={key:0,class:"bg-warning rounded text-center"},X={key:1,class:"bg-success rounded text-center"},Y={key:2,class:"bg-secondary rounded text-center"},Z={key:3,class:"bg-danger rounded text-center text-white"},ee={key:4,class:"bg-primary rounded text-center text-white"},te=n(()=>e("button",{class:"btn btn-warning","data-toggle":"modal","data-target":"#editInvoice"}," Update ",-1)),oe={key:0,class:"btn btn-success","data-toggle":"modal","data-target":"#perpanjangModal"},ae=n(()=>e("div",{class:"col-1"},null,-1)),ne={class:"modal fade",id:"addInvoiceModal",tabindex:"-1",role:"dialog","aria-labelledby":"addInvoiceModalLabel","aria-hidden":"true",ref:"addInvoiceModalRef"},se={class:"modal-dialog",role:"document"},ie={class:"modal-content"},re=n(()=>e("div",{class:"modal-header"},[e("h5",{class:"modal-title",id:"addInvoiceModalLabel"},"Tambah Invoice"),e("button",{type:"button",class:"close","data-dismiss":"modal","aria-label":"Close"},[e("span",{"aria-hidden":"true"},"×")])],-1)),le={class:"modal-body"},de=n(()=>e("div",{class:"form-group"},[e("label",{for:"durasi"},"Durasi"),e("input",{type:"text",class:"form-control",id:"durasi",value:"1 Bulan",disabled:""})],-1)),ue={class:"form-group"},ce=n(()=>e("label",{for:"rekeningTujuan"},"Rekening Tujuan",-1)),me={class:"form-group"},pe=n(()=>e("label",{for:"bayar"},"Jumlah Bayar",-1)),he={class:"form-group"},ge=n(()=>e("label",{for:"rekeningPengirim"},"Rekening Pengirim",-1)),be={class:"form-group"},_e=n(()=>e("label",{for:"jumlahTransfer"},"Jumlah Transfer",-1)),fe={class:"form-group"},ve=n(()=>e("label",{for:"buktiTransfer"},"Bukti Transfer",-1)),ke=n(()=>e("div",{class:"modal-footer"},[e("button",{type:"button",class:"btn btn-secondary","data-dismiss":"modal"}," Close "),e("button",{type:"submit",class:"btn btn-primary"},"Tambah")],-1)),ye={class:"modal fade",id:"editInvoice",tabindex:"-1",role:"dialog","aria-labelledby":"editInvoiceLabel","aria-hidden":"true",ref:"editInvoiceRef"},Ie={class:"modal-dialog",role:"document"},we={class:"modal-content"},je=n(()=>e("div",{class:"modal-header"},[e("h5",{class:"modal-title",id:"editInvoiceLabel"},"Edit Invoice"),e("button",{type:"button",class:"close","data-dismiss":"modal","aria-label":"Close"},[e("span",{"aria-hidden":"true"},"×")])],-1)),Te={class:"modal-body"},Be=n(()=>e("div",{class:"form-group"},[e("label",{for:"durasi"},"Durasi"),e("input",{type:"text",class:"form-control",id:"durasi",value:"1 Bulan",disabled:""})],-1)),De={class:"form-group"},Ue=n(()=>e("label",{for:"rekeningTujuan"},"Rekening Tujuan",-1)),Se={class:"form-group"},Ce=n(()=>e("label",{for:"bayar"},"Jumlah Bayar",-1)),Me={class:"form-group"},Pe=n(()=>e("label",{for:"rekeningPengirim"},"Rekening Pengirim",-1)),Ve={class:"form-group"},Re=n(()=>e("label",{for:"jumlahTransfer"},"Jumlah Transfer",-1)),$e={class:"form-group"},Fe=n(()=>e("label",{for:"buktiTransfer"},"Bukti Transfer",-1)),Ae=n(()=>e("div",{class:"modal-footer"},[e("button",{type:"button",class:"btn btn-secondary","data-dismiss":"modal"}," Close "),e("button",{type:"submit",class:"btn btn-primary"},"Edit")],-1)),Je={class:"modal fade",id:"perpanjangModal",tabindex:"-1",role:"dialog","aria-labelledby":"perpanjangModalLabel","aria-hidden":"true",ref:"perpanjangModalRef"},Le={class:"modal-dialog",role:"document"},Ne={class:"modal-content"},xe=n(()=>e("div",{class:"modal-header"},[e("h5",{class:"modal-title",id:"perpanjangModalLabel"},"Perpanjang Invoice"),e("button",{type:"button",class:"close","data-dismiss":"modal","aria-label":"Close"},[e("span",{"aria-hidden":"true"},"×")])],-1)),ze={class:"modal-body"},Ee=n(()=>e("div",{class:"form-group"},[e("label",{for:"durasi"},"Durasi"),e("input",{type:"text",class:"form-control",id:"durasi",value:"1 Bulan",disabled:""})],-1)),Oe={class:"form-group"},He=n(()=>e("label",{for:"rekeningTujuan"},"Rekening Tujuan",-1)),Ke={class:"form-group"},qe=n(()=>e("label",{for:"bayar"},"Jumlah Bayar",-1)),Ge={class:"form-group"},We=n(()=>e("label",{for:"rekeningPengirim"},"Rekening Pengirim",-1)),Qe={class:"form-group"},Xe=n(()=>e("label",{for:"jumlahTransfer"},"Jumlah Transfer",-1)),Ye={class:"form-group"},Ze=n(()=>e("label",{for:"buktiTransfer"},"Bukti Transfer",-1)),et=n(()=>e("div",{class:"modal-footer"},[e("button",{type:"button",class:"btn btn-secondary","data-dismiss":"modal"}," Close "),e("button",{type:"submit",class:"btn btn-primary"},"Perpanjang")],-1));y.use(F);const tt={data(){return{invoices:[],newInvoice:{nomor_rekening:"",jumlah_transfer:"",bukti_transfer:null},rekenings:[],user_id:null,role:null,ready:null,today:null}},methods:{async fetchDataInvoice(){try{const s=await f.get(`https://backend-webmember.lumirainternational.com/api/auth/list-myinvoice/${this.user_id}`,{headers:{Authorization:"Bearer "+sessionStorage.getItem("token")}});this.invoices=s.data.data,this.ready=!0,console.log("tanggal :",s.data.data[0].tanggal_berakhir),console.log(new Date(s.data.data[0].tanggal_berakhir)<new Date),console.log("sekarang:",new Date)}catch(s){console.error(s)}},async fetchDataRekening(){try{const s=await f.get("https://backend-webmember.lumirainternational.com/api/auth/get-rekening",{headers:{Authorization:"Bearer "+sessionStorage.getItem("token")}});this.rekenings=s.data.data}catch(s){console.error(s)}},addInvoice(s=null){this.ready=!1;const i=new FormData;i.append("nomor_rekening",this.newInvoice.nomor_rekening),i.append("jumlah_transfer",this.newInvoice.jumlah_transfer),i.append("bukti_transfer",this.newInvoice.bukti_transfer),i.append("user_id",this.user_id),s!==null&&i.append("status",s),f.post("https://backend-webmember.lumirainternational.com/api/auth/create-invoice",i,{headers:{"Content-Type":"multipart/form-data",Authorization:"Bearer "+sessionStorage.getItem("token")}}).then(c=>{console.log(c.data),this.newInvoice={nomor_rekening:"",jumlah_transfer:"",bukti_transfer:null},this.fetchDataInvoice(),this.showAlert()}).catch(c=>{console.error(c)})},showAlert(){this.$swal({title:"Request Success",text:"Data Berhasil Dikirim!",icon:"success"}).then(()=>{$("#addInvoiceModal").modal("hide"),$("#editInvoice").modal("hide"),$("#perpanjangModal").modal("hide")})},handleFileUpload(s){this.newInvoice.bukti_transfer=s.target.files[0]}},created(){const s=sessionStorage.getItem("token");if(s)try{const[i,c]=s.split("."),b=JSON.parse(atob(i)),a=atob(c),o=JSON.parse(atob(s.split(".")[1])),t=o.exp,p=new Date(t*1e3);console.log("Waktu Kedaluwarsa (UTC):",p.toUTCString()),new Date>p?(console.log("Keluar"),sessionStorage.removeItem("token"),this.$router.push("/")):console.log("Aman");const I=o.level;this.user_id=o.id,console.log("ini idddd:",this.user_id),I!=="0"?this.$router.push("/unauthorized"):(!b||!a)&&this.$router.push("/"),this.fetchDataInvoice(),this.fetchDataRekening(),this.today=new Date}catch(i){console.error("Error decoding token:",i),this.$router.push("/")}else this.$router.push("/")}},ot=Object.assign(tt,{__name:"MyInvoice",setup(s){const i=v(!1),c=v(""),b=()=>{i.value=!i.value,c.value=i.value?"toggle-sidebar":""};return(a,o)=>(d(),u(k,null,[e("div",A,[h(P,{class:j(c.value)},null,8,["class"]),e("div",J,[e("div",L,[h(V,{onToggleSidebar:b}),h(R),N,e("div",x,[z,e("div",E,[O,e("div",H,[a.ready?m("",!0):(d(),u("div",K)),a.ready?(d(),T(D(y),{key:1,class:"tableCustom display table table-striped"},{default:B(()=>[q,e("tbody",null,[(d(!0),u(k,null,U(a.invoices,(t,p)=>(d(),u("tr",{key:t.id},[e("th",G,g(p+1),1),e("td",null,g(t.nomor_rekening),1),e("td",null,g(t.jumlah_transfer),1),e("td",null,[e("img",{src:"https://backend-webmember.lumirainternational.com/storage/"+t.bukti_transfer,alt:"Bukti Transfer",style:{"max-width":"100px"}},null,8,W)]),e("td",null,g(t.tanggal_berakhir!=null?t.tanggal_berakhir:"Belum Diatur"),1),e("td",null,[t.status=="0"?(d(),u("div",Q," Pending ")):m("",!0),t.status=="1"?(d(),u("div",X," Active ")):m("",!0),t.status=="3"?(d(),u("div",Y," Expired ")):m("",!0),t.status=="2"?(d(),u("div",Z," Reject ")):m("",!0),t.status=="00"?(d(),u("div",ee," Perpanjang ")):m("",!0)]),e("td",null,[te,t.status=="3"?(d(),u("button",oe," Perpanjang ")):m("",!0)])]))),128))])]),_:1})):m("",!0)])]),ae])]),h(S)])]),e("div",ne,[e("div",se,[e("div",ie,[re,e("div",le,[e("form",{onSubmit:o[5]||(o[5]=_((...t)=>a.addInvoice&&a.addInvoice(...t),["prevent"]))},[de,e("div",ue,[ce,r(e("input",{type:"text",class:"form-control",id:"rekeningTujuan","onUpdate:modelValue":o[0]||(o[0]=t=>a.rekenings.rekening_tujuan=t),disabled:""},null,512),[[l,a.rekenings.rekening_tujuan]])]),e("div",me,[pe,r(e("input",{type:"text",class:"form-control",id:"bayar","onUpdate:modelValue":o[1]||(o[1]=t=>a.rekenings.harga=t),disabled:""},null,512),[[l,a.rekenings.harga]])]),e("div",he,[ge,r(e("input",{type:"text",class:"form-control",id:"rekeningPengirim","onUpdate:modelValue":o[2]||(o[2]=t=>a.newInvoice.nomor_rekening=t)},null,512),[[l,a.newInvoice.nomor_rekening]])]),e("div",be,[_e,r(e("input",{type:"text",class:"form-control",id:"jumlahTransfer","onUpdate:modelValue":o[3]||(o[3]=t=>a.newInvoice.jumlah_transfer=t)},null,512),[[l,a.newInvoice.jumlah_transfer]])]),e("div",fe,[ve,e("input",{type:"file",class:"form-control",id:"buktiTransfer",onChange:o[4]||(o[4]=(...t)=>a.handleFileUpload&&a.handleFileUpload(...t))},null,32)]),ke],32)])])])],512),e("div",ye,[e("div",Ie,[e("div",we,[je,e("div",Te,[e("form",{onSubmit:o[11]||(o[11]=_(t=>a.addInvoice("0"),["prevent"]))},[Be,e("div",De,[Ue,r(e("input",{type:"text",class:"form-control",id:"rekeningTujuan","onUpdate:modelValue":o[6]||(o[6]=t=>a.rekenings.rekening_tujuan=t),disabled:""},null,512),[[l,a.rekenings.rekening_tujuan]])]),e("div",Se,[Ce,r(e("input",{type:"text",class:"form-control",id:"bayar","onUpdate:modelValue":o[7]||(o[7]=t=>a.rekenings.harga=t),disabled:""},null,512),[[l,a.rekenings.harga]])]),e("div",Me,[Pe,r(e("input",{type:"text",class:"form-control",id:"rekeningPengirim","onUpdate:modelValue":o[8]||(o[8]=t=>a.newInvoice.nomor_rekening=t)},null,512),[[l,a.newInvoice.nomor_rekening]])]),e("div",Ve,[Re,r(e("input",{type:"text",class:"form-control",id:"jumlahTransfer","onUpdate:modelValue":o[9]||(o[9]=t=>a.newInvoice.jumlah_transfer=t)},null,512),[[l,a.newInvoice.jumlah_transfer]])]),e("div",$e,[Fe,e("input",{type:"file",class:"form-control",id:"buktiTransfer",onChange:o[10]||(o[10]=(...t)=>a.handleFileUpload&&a.handleFileUpload(...t))},null,32)]),Ae],32)])])])],512),e("div",Je,[e("div",Le,[e("div",Ne,[xe,e("div",ze,[e("form",{onSubmit:o[17]||(o[17]=_(t=>a.addInvoice("00"),["prevent"]))},[Ee,e("div",Oe,[He,r(e("input",{type:"text",class:"form-control",id:"rekeningTujuan","onUpdate:modelValue":o[12]||(o[12]=t=>a.rekenings.rekening_tujuan=t),disabled:""},null,512),[[l,a.rekenings.rekening_tujuan]])]),e("div",Ke,[qe,r(e("input",{type:"text",class:"form-control",id:"bayar","onUpdate:modelValue":o[13]||(o[13]=t=>a.rekenings.harga=t),disabled:""},null,512),[[l,a.rekenings.harga]])]),e("div",Ge,[We,r(e("input",{type:"text",class:"form-control",id:"rekeningPengirim","onUpdate:modelValue":o[14]||(o[14]=t=>a.newInvoice.nomor_rekening=t)},null,512),[[l,a.newInvoice.nomor_rekening]])]),e("div",Qe,[Xe,r(e("input",{type:"text",class:"form-control",id:"jumlahTransfer","onUpdate:modelValue":o[15]||(o[15]=t=>a.newInvoice.jumlah_transfer=t)},null,512),[[l,a.newInvoice.jumlah_transfer]])]),e("div",Ye,[Ze,e("input",{type:"file",class:"form-control",id:"buktiTransfer",onChange:o[16]||(o[16]=(...t)=>a.handleFileUpload&&a.handleFileUpload(...t))},null,32)]),et],32)])])])],512)],64))}}),rt=w(ot,[["__scopeId","data-v-928d7acd"]]);export{rt as default};
