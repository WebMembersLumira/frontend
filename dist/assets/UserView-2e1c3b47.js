import{_ as S,j as w,o as n,c as d,d as e,f as _,A as f,B as D,t as h,n as C,g as B,C as U,w as x,e as I,v as T,F as v,b as m,S as k,N as A,D as P,E as g,G as N,y as V,z}from"./index-952a9ce0.js";import{P as y,D as E}from"./jquery.dataTables-c90b7baa.js";const l=t=>(V("data-v-9f2d7789"),t=t(),z(),t),F={id:"wrapper"},K={id:"content-wrapper",class:"d-flex flex-column"},L={id:"content"},O=l(()=>e("h1",{class:"h3 mb-0 text-gray-800 text-center"},"Halaman User",-1)),j={class:"row"},J=l(()=>e("div",{class:"col-1"},null,-1)),M={class:"col-10"},W=l(()=>e("div",{class:"row mt-5"},[e("div",{class:"col-sm-3"}),e("div",{class:"col-sm-9"})],-1)),q={class:"table-responsive"},G={key:0,class:"preloader"},H=l(()=>e("thead",null,[e("tr",null,[e("th",{scope:"col"},"No"),e("th",{scope:"col"},"Nama"),e("th",{scope:"col"},"Email"),e("th",{scope:"col"},"Status"),e("th",{scope:"col"},"Aksi")])],-1)),R={scope:"row"},Y={key:0,class:"bi bi-hourglass-split text-warning"},Q={key:1,class:"bi bi-check-lg text-success"},X={key:2,class:"bi bi-x-lg text-danger"},Z={class:"pe-5"},ee={class:"row"},te={class:"col-4"},se=["href"],oe=l(()=>e("i",{class:"fab fa-whatsapp"},null,-1)),ae=[oe],le={class:"col-4"},ne=["onClick"],ie=l(()=>e("i",{class:"bi bi-pencil-square"},null,-1)),de=[ie],re={class:"col-4"},ce=["onClick"],he=l(()=>e("i",{class:"bi bi-trash-fill"},null,-1)),ue=[he],pe=l(()=>e("div",{class:"col-1"},null,-1)),_e={class:"modal fade",id:"updatepw",tabindex:"-1",role:"dialog","aria-labelledby":"updatepwLabel","aria-hidden":"true",ref:"updatepwRef"},me={class:"modal-dialog",role:"document"},ge={class:"modal-content"},be=l(()=>e("div",{class:"modal-header"},[e("h5",{class:"modal-title",id:"updatepwLabel"},"Ubah Password"),e("button",{type:"button",class:"close","data-dismiss":"modal","aria-label":"Close"},[e("span",{"aria-hidden":"true"},"Ã—")])],-1)),we={class:"modal-body"},fe={class:"form-group"},ve=l(()=>e("label",{for:"pw"},"Password Baru",-1)),ke=l(()=>e("div",{class:"modal-footer"},[e("button",{type:"button",class:"btn btn-secondary","data-dismiss":"modal"}," Batal "),e("button",{type:"submit",class:"btn btn-primary"},"Update")],-1));y.use(E);const ye={data(){return{user:[],ready:null,selectedUserId:"",newPw:""}},methods:{selectedUser(t){this.selectedUserId=t},updatePw(){const t=new FormData;t.append("password",this.newPw),console.log("test id: ",this.selectedUserId),m.post(`https://backend.alicornbot.com/api/auth/update-pw/${this.selectedUserId}`,t,{headers:{"Content-Type":"multipart/form-data",Authorization:"Bearer "+sessionStorage.getItem("token")}}).then(s=>{console.log(s.data),k.fire({title:"Update Success",text:"Data Berhasil Diupdate!",icon:"success"}).then(()=>{$("#updatepw").modal("hide")})}).catch(s=>{console.error(s)})},async fetchData(){const t=await m.get("https://backend.alicornbot.com/api/auth/list-user",{headers:{Authorization:"Bearer "+sessionStorage.getItem("token")}});this.user=t.data.data,this.ready=!0},confirmDelete(t){k.fire({title:"Konfirmasi",text:"Apakah Anda yakin ingin menghapus item ini?",icon:"warning",showCancelButton:!0,confirmButtonText:"Ya",cancelButtonText:"Tidak"}).then(s=>{s.isConfirmed&&this.deleteItem(t)})},deleteItem(t){m.delete(`https://backend.alicornbot.com/api/auth/delete-user/${t}`,{headers:{Authorization:"Bearer "+sessionStorage.getItem("token")}}).then(s=>{console.log(s.data),this.ready=!1,this.showAlert(),this.fetchData()}).catch(s=>{console.error(s)})},showAlert(){this.$swal({title:"Delete Success",text:"Data Berhasil Dihapus!",icon:"success"}).then(()=>{$("#aturTanggal").modal("hide")})}},created(){const t=new Date().toUTCString();console.log("Waktu Sekarang (UTC):",t);const s=sessionStorage.getItem("token");if(s)try{const[r,u]=s.split("."),a=JSON.parse(atob(r)),i=atob(u),o=JSON.parse(atob(s.split(".")[1])),p=o.exp,c=new Date(p*1e3);console.log("Waktu Kedaluwarsa (UTC):",c.toUTCString()),new Date>c?(console.log("Keluar"),sessionStorage.removeItem("token"),this.$router.push("/")):console.log("Aman");const b=o.level;console.log("level:",b),b!=="1"?this.$router.push("/unauthorized"):(!a||!i)&&(this.$router.push("/"),sessionStorage.removeItem("token")),this.fetchData()}catch(r){console.error("Error decoding token:",r),this.$router.push("/")}else this.$router.push("/")}},Se=Object.assign(ye,{__name:"UserView",setup(t){const s=w(!1),r=w(""),u=()=>{s.value=!s.value,r.value=s.value?"toggle-sidebar":""};return(a,i)=>(n(),d(v,null,[e("div",F,[_(D,{class:f(r.value)},null,8,["class"]),e("div",K,[e("div",L,[_(A,{onToggleSidebar:u}),O,e("div",j,[J,e("div",M,[W,e("div",q,[a.ready?h("",!0):(n(),d("div",G)),a.ready?(n(),C(U(y),{key:1,class:"display table table-striped"},{default:B(()=>[H,e("tbody",null,[(n(!0),d(v,null,P(a.user,(o,p)=>(n(),d("tr",{key:o.id},[e("th",R,g(p+1),1),e("td",null,g(o.name),1),e("td",null,g(o.email),1),e("td",null,[o.status=="0"?(n(),d("i",Y)):h("",!0),o.status=="1"?(n(),d("i",Q)):h("",!0),o.status=="2"?(n(),d("i",X)):h("",!0)]),e("td",Z,[e("div",ee,[e("div",te,[e("a",{target:"_blank",href:"https://api.whatsapp.com/send?phone=62"+o.no_hp},[e("div",{class:f(["whatsapp-icon",{active:a.showChatBox}]),onClick:i[0]||(i[0]=(...c)=>a.toggleChatBox&&a.toggleChatBox(...c))},ae,2)],8,se)]),e("div",le,[e("button",{onClick:c=>a.selectedUser(o.id),"data-toggle":"modal","data-target":"#updatepw",class:"btn btn-warning customDetail"},de,8,ne)]),e("div",re,[o.role!="admin"?(n(),d("button",{key:0,onClick:c=>a.confirmDelete(o.id),class:"btn btn-danger customDetail"},ue,8,ce)):h("",!0)])])])]))),128))])]),_:1})):h("",!0)])]),pe])]),_(N)])]),e("div",_e,[e("div",me,[e("div",ge,[be,e("div",we,[e("form",{onSubmit:i[2]||(i[2]=x((...o)=>a.updatePw&&a.updatePw(...o),["prevent"]))},[e("div",fe,[ve,I(e("input",{type:"text",class:"form-control",id:"pw","onUpdate:modelValue":i[1]||(i[1]=o=>a.newPw=o)},null,512),[[T,a.newPw]])]),ke],32)])])])],512)],64))}}),Be=S(Se,[["__scopeId","data-v-9f2d7789"]]);export{Be as default};
